<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8' />
    <link rel="stylesheet" type="text/css" href="../../lib/css/themes/jquery-ui/redmond/jquery-ui.min.css" />
    <link rel="stylesheet" type="text/css" href="../../lib/css/themes/jquery-ui/redmond/jquery-ui.structure.min.css" />
    <link rel="stylesheet" type="text/css" href="../../lib/css/themes/jquery-ui/redmond/jquery-ui.theme.min.css" />
    <link rel="stylesheet" type="text/css" href="lib/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="lib/css/font-awesome.min.css" />
    <link rel="stylesheet" type="text/css" href="lib/css/statemachine.css" />
    <link rel="stylesheet" type="text/css" href="lib/css/vis.min.css" />
    <!--link rel="stylesheet" type="text/css" href="lib/css/vis-network.min.css" /-->

    <script type="text/javascript" src="../../lib/js/jquery-1.11.1.min.js"></script>
    <script type="text/javascript" src="../../socket.io/socket.io.js"></script>
    <script type="text/javascript" src="../../lib/js/jquery-ui.min.js"></script>
    <script type="text/javascript" src="lib/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="lib/js/bootbox.min.js"></script>
    <script type="text/javascript" src="lib/js/showdown.min.js"></script>
    <script type="text/javascript" src="lib/js/vis.min.js"></script>

    <script type="text/javascript" src="../../lib/js/translate.js"></script>
    <script type="text/javascript" src="../../lib/js/selectID.js"></script>
    <script type="text/javascript" src="../../lib/js/loStorage.js"></script>

    <script type="text/javascript" src="lib/js/words.js"></script>
    <script type="text/javascript" src="lib/js/statemachine.js"></script>

    <style type="text/css">
        body,
        select {
            font: 10pt sans;
        }

        #mynetwork {
            position: relative;
            width: 1000px;
            height: 800px;
            border: 2px solid lightgray;
        }

        #config {
            float: left;
            width: 400px;
            height: 600px;
        }

        p {
            font-size: 16px;
            max-width: 700px;
        }

        table.legend_table {
            font-size: 11px;
            border-width: 1px;
            border-color: #d3d3d3;
            border-style: solid;
        }

        table.legend_table,
        td {
            border-width: 2px;
            border-color: #d3d3d3;
            border-style: solid;
            padding: 2px;
        }

        div.table_content {
            width: 80px;
            text-align: center;
        }

        div.table_description {
            width: 100px;
        }

        #operation {
            font-size: 28px;
        }

        #node-popUp {
            display: none;
            position: absolute;
            top: 350px;
            left: 170px;
            z-index: 299;
            width: 300px;
            height: 150px;
            background-color: #f9f9f9;
            border-style: solid;
            border-width: 3px;
            border-color: #5394ed;
            padding: 10px;
            text-align: center;
        }

        #edge-popUp {
            display: none;
            position: absolute;
            top: 350px;
            left: 170px;
            z-index: 299;
            width: 300px;
            height: 120px;
            background-color: #f9f9f9;
            border-style: solid;
            border-width: 3px;
            border-color: #5394ed;
            padding: 10px;
            text-align: center;
        }
    </style>

    <script type="text/javascript">
        var nodes = null;
        var edges = null;
        var network = null;
        // randomly create some nodes and edges
        var data = getScaleFreeNetwork(25);
        var seed = 2;

        function setDefaultLocale() {
            var defaultLocal = navigator.language;
            var select = document.getElementById('locale');
            select.selectedIndex = 0; // set fallback value
            for (var i = 0, j = select.options.length; i < j; ++i) {
                if (select.options[i].getAttribute('value') === defaultLocal) {
                    select.selectedIndex = i;
                    break;
                }
            }
        }

        function destroy() {
            if (network !== null) {
                network.destroy();
                network = null;
            }
        }

        function draw() {
            destroy();
            nodes = [];
            edges = [];

            // create a network
            var container = document.getElementById('mynetwork');
            var options = {
                physics: {
                    stabilization: false,
                    physics: {
                        barnesHut: {
                            centralGravity: 0.05,
                            springLength: 180
                        },
                    },
                    interaction: {
                        hover: true,
                        navigationButtons: true,
                        tooltipDelay: 250
                    },
                    configure: true,
                    nodes: {
                        borderWidthSelected: 6,
                        color: {
                            highlight: {},
                            hover: {}
                        },
                        font: {
                            size: 27,
                            face: "verdana",
                            strokeWidth: null
                        },
                        scaling: {
                            min: 5,
                            max: null
                        },
                        shapeProperties: {
                            borderRadius: null
                        },
                        size: 24
                    },
                    edges: {
                        arrows: {
                            to: {
                                enabled: true
                            }
                        },
                        color: {
                            inherit: false
                        },
                        font: {
                            color: "rgba(15,52,21,1)"
                        },
                        selfReferenceSize: 35,
                        shadow: {
                            enabled: true
                        },
                        smooth: {
                            forceDirection: "none",
                            roundness: 0.75
                        }
                    },
                    layout: {
                        randomSeed: seed
                    }, // just to make sure the layout is the same when the locale is changed
                    locale: document.getElementById('locale').value,
                    manipulation: {
                        enabled: true,
                        initiallyActive: true,
                        addNode: function (data, callback) {
                            // filling in the popup DOM elements
                            document.getElementById('node-operation').innerHTML = "Add Node";
                            editNode(data, clearNodePopUp, callback);
                        },
                        editNode: function (data, callback) {
                            // filling in the popup DOM elements
                            document.getElementById('node-operation').innerHTML = "Edit Node";
                            editNode(data, cancelNodeEdit, callback);
                        },
                        addEdge: function (data, callback) {
                            if (data.from == data.to) {
                                var r = confirm("Do you want to connect the node to itself?");
                                if (r != true) {
                                    callback(null);
                                    return;
                                }
                            }
                            document.getElementById('edge-operation').innerHTML = "Add Edge";
                            editEdgeWithoutDrag(data, callback);
                        },
                        editEdge: {
                            editWithoutDrag: function (data, callback) {
                                document.getElementById('edge-operation').innerHTML = "Edit Edge";
                                editEdgeWithoutDrag(data, callback);
                            }
                        }
                    }
                };
                network = new vis.Network(container, data, options);
                network.on("configChange", function () {
                    // this will immediately fix the height of the configuration
                    // wrapper to prevent unecessary scrolls in chrome.
                    // see https://github.com/almende/vis/issues/1568
                    var div = container.getElementsByClassName('vis-configuration-wrapper')[0];
                    div.style["height"] = div.getBoundingClientRect().height + "px";
                });
            }

            function editNode(data, cancelAction, callback) {
                document.getElementById('node-label').value = data.label;
                document.getElementById('node-saveButton').onclick = saveNodeData.bind(this, data, callback);
                document.getElementById('node-cancelButton').onclick = cancelAction.bind(this, callback);
                document.getElementById('node-popUp').style.display = 'block';
            }

            // Callback passed as parameter is ignored
            function clearNodePopUp() {
                document.getElementById('node-saveButton').onclick = null;
                document.getElementById('node-cancelButton').onclick = null;
                document.getElementById('node-popUp').style.display = 'none';
            }

            function cancelNodeEdit(callback) {
                clearNodePopUp();
                callback(null);
            }

            function saveNodeData(data, callback) {
                data.label = document.getElementById('node-label').value;
                clearNodePopUp();
                callback(data);
            }

            function editEdgeWithoutDrag(data, callback) {
                // filling in the popup DOM elements
                document.getElementById('edge-label').value = data.label;
                document.getElementById('edge-saveButton').onclick = saveEdgeData.bind(this, data, callback);
                document.getElementById('edge-cancelButton').onclick = cancelEdgeEdit.bind(this, callback);
                document.getElementById('edge-popUp').style.display = 'block';
            }

            function clearEdgePopUp() {
                document.getElementById('edge-saveButton').onclick = null;
                document.getElementById('edge-cancelButton').onclick = null;
                document.getElementById('edge-popUp').style.display = 'none';
            }

            function cancelEdgeEdit(callback) {
                clearEdgePopUp();
                callback(null);
            }

            function saveEdgeData(data, callback) {
                if (typeof data.to === 'object')
                    data.to = data.to.id
                if (typeof data.from === 'object')
                    data.from = data.from.id
                data.label = document.getElementById('edge-label').value;
                clearEdgePopUp();
                callback(data);
            }

            function init() {
                setDefaultLocale();
                draw();
            }
    </script>
</head>

<body onload="init();">

    <div id="homeTemplate">
        <div class="page-title">
            <div class="title_left">

            </div>
            <div class="title_right">

            </div>
        </div>
        <div class="clearfix"></div>

        <div id="home-container">

            <div class="row justify-content-start">

                <div class="col-lg-2 col-md-2 col-sm-4 col-xs-8">
                    <div class="tile-stats">
                        <p>
                            <label for="locale">Select a locale:</label>
                            <select id="locale" onchange="draw();">
                                <option value="en">en</option>
                                <option value="de">de</option>
                                <option value="es">es</option>
                                <option value="it">it</option>
                                <option value="nl">nl</option>
                                <option value="pt-br">pt</option>
                                <option value="ru">ru</option>
                            </select>
                        </p>
                        <div class="tile-stats">
                            <div id="node-popUp">
                                <span id="node-operation">node</span>
                                <br>
                                <table style="margin:auto;">
                                    <tr>
                                        <td>id</td>
                                        <td>
                                            <input id="node-id" value="new value" />
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>label</td>
                                        <td>
                                            <input id="node-label" value="new value" />
                                        </td>
                                    </tr>
                                </table>
                                <input type="button" value="save" id="node-saveButton" />
                                <input type="button" value="cancel" id="node-cancelButton" />
                            </div>
                        </div>
                        <div id="edge-popUp">
                            <span id="edge-operation">edge</span>
                            <br>
                            <table style="margin:auto;">
                                <tr>
                                    <td>label</td>
                                    <td>
                                        <input id="edge-label" value="new value" />
                                    </td>
                                </tr>
                            </table>
                            <input type="button" value="save" id="edge-saveButton" />
                            <input type="button" value="cancel" id="edge-cancelButton" />
                        </div>

                        <br />
                        <div id="mynetwork"></div>
                        <p id="selection"></p>
                    </div>
                </div>

                <div class="col-lg-2 col-md-2 col-sm-4 col-xs-8">
                </div>
            </div>
        </div>

        <div class="row">

            <!--div id="homeUpdateListTab" class="col-lg-4 col-md-6 col-sm-6 col-xs-12">
                <div class="x_panel">
                    <div class="x_title">
                        <h2>
                            <span class="translate">Updates</span>
                            <small class="translate">can be done here</small>
                        </h2>
                        <ul class="nav navbar-right panel_toolbox">
                            <li>
                                <a class="collapse-link">
                                    <i class="fa fa-chevron-up"></i>
                                </a>
                            </li>
                        </ul>
                        <div class="clearfix"></div>
                    </div>
                    <div class="x_content height_320">
                        <div class="">
                            <ul id="updateHomeList"></ul>
                        </div>
                    </div>
                </div>
            </div>

            <div id="homeNewAdapterTab" class="col-lg-4 col-md-6 col-sm-6 col-xs-12">
                <div class="x_panel">
                    <div class="x_title">
                        <h2>
                            <span class="translate">New adapters</span>
                            <small class="translate">are listed here</small>
                        </h2>
                        <ul class="nav navbar-right panel_toolbox">
                            <li>
                                <a class="collapse-link">
                                    <i class="fa fa-chevron-up"></i>
                                </a>
                            </li>
                        </ul>
                        <div class="clearfix"></div>
                    </div>
                    <div class="x_content height_150">
                        <div class="">
                            <ul id="newHomeList"></ul>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
                        <div class="tile-stats">

                        </div>
                    </div>

                    <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12">
                        <div class="tile-stats">

                        </div>
                    </div>
                </div>
            </div>

            <div id="systemInfoTab" class="col-lg-4 col-md-12 col-sm-12 col-xs-12">
                <div class="x_panel">
                    <div class="x_title">
                        <h2>
                            <span class="translate">System informations</span>
                            <small class="translate">about the server</small>
                        </h2>
                        <ul class="nav navbar-right panel_toolbox">
                            <li>
                                <a class="collapse-link">
                                    <i class="fa fa-chevron-up"></i>
                                </a>
                            </li>
                        </ul>
                        <div class="clearfix"></div>
                    </div>
                    <div class="x_content height_320">
                        <div id="systemInfoList">
                        </div>
                    </div>
                </div>
            </div>

        </div>

        <div class="row">

            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-6" id="newsBlock">
                <div class="x_panel">
                    <div class="x_title">
                        <h2 id="newsTitle">ioBroker News
                            <small id="newsTime"></small>
                        </h2>
                        <ul class="nav navbar-right panel_toolbox">
                            <li>
                                <a class="collapse-link">
                                    <i class="fa fa-chevron-up"></i>
                                </a>
                            </li>
                            <li>
                                <a id="news-link" target="_blank">
                                    <i class="fa fa-globe"></i>
                                </a>
                            </li>
                        </ul>
                        <div class="clearfix"></div>
                    </div>
                    <div class="x_content">
                        <ul class="list-unstyled timeline" id="newsList">

                        </ul>

                    </div>
                </div>
            </div>

            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-6" id="forumBlock">
                <div class="x_panel">
                    <div class="x_title">
                        <h2 id="forumTitle">ioBroker Forum
                            <small id="forumTime"></small>
                        </h2>
                        <ul class="nav navbar-right panel_toolbox">
                            <li>
                                <a class="collapse-link">
                                    <i class="fa fa-chevron-up"></i>
                                </a>
                            </li>
                            <li>
                                <a id="forum-link" target="_blank">
                                    <i class="fa fa-globe"></i>
                                </a>
                            </li>
                        </ul>
                        <div class="clearfix"></div>
                    </div>
                    <div class="x_content">
                        <ul class="list-unstyled timeline" id="forumList">

                        </ul>

                    </div>
                </div>
            </div-->

        </div>
    </div>

    <!-- Forum Entry -->
    <ul id="forumEntryTemplate" class="hidden">
        <li>
            <div class="block">
                <div class="tags hidden-xs">
                    <a href="" class="tag">
                        <span class="forumClass"></span>
                    </a>
                </div>
                <div class="block_content">
                    <h2 class="title">
                        <a target="_blank" class="titleLink">Who Needs Sundance When You’ve Got&nbsp;Crowdfunding?</a>
                    </h2>
                    <div class="byline"></div>
                    <br/>
                    <p class="description">Film festivals used to be do-or-die moments for movie makers. They were where you met the producers that
                        could fund your project, and if the buyers liked your flick, they’d pay to Fast-forward and…
                        <a>Read&nbsp;More</a>
                    </p>
                </div>
            </div>
        </li>
    </ul>
    <!-- / Forum Entry -->

    <!-- UpdateList -->
    <ul id="updateHomeListTemplate" class="hidden">
        <li>
            <p>
                <a class="btn btn-default adapter-update-submit">
                    <i class="fa fa-refresh"></i>
                </a>&nbsp;
                <span class="title">fronius adapter</span>&nbsp;
                <span class="version">0.0.6</span>&nbsp;
                <i class="fa fa-arrow-right"></i>&nbsp;
                <strong class="newVersion">0.1.0</strong>&nbsp;
                <a href="javascript:;" class="adapter-readme-submit show-md">
                    <i class="fa fa-file-text text-info"></i>
                </a>
                <a class="notesVersion" title="infos">
                    <i class="fa fa-info-circle text-info"></i>
                </a>
            </p>
        </li>
    </ul>
    <!-- / UpdateList -->

    <!-- NewList -->
    <ul id="newHomeListTemplate" class="hidden">
        <li>
            <p>
                <a class="btn btn-default adapter-install-submit">
                    <i class="fa fa-plus"></i>
                </a>&nbsp;
                <span class="title">fronius adapter</span>&nbsp;
                <span class="version">0.0.6</span>&nbsp;
                <a href="javascript:;" class="adapter-readme-submit show-md">
                    <i class="fa fa-file-text text-info"></i>
                </a>
            </p>
        </li>
    </ul>
    <!-- / NewList -->

    <!-- Install/Update -->
    <div id="modal-command" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="modal-command" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal">
                        <i class="fa fa-window-minimize"></i>
                    </button>
                    <h4 class="modal-title" id="modal-command-label">Modal title</h4>
                </div>
                <div class="modal-body">
                    <div id="adapter-meter" class="meter">
                        <span style="width: 1%;"></span>
                    </div>
                    <p id="adapter-install-message-on-end">&nbsp;</p>
                    <a data-toggle="collapse" href="#collapseApadpterInstallDetails" aria-expanded="false" aria-controls="collapseApadpterInstallDetails">
                        <span data-i18n="details">Details</span> ...
                    </a>
                    <div class="collapse" id="collapseApadpterInstallDetails">
                        <textarea class="command" id="stdout" disabled="disabled" cols="120" rows="30"></textarea>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default translate" id="adapter-install-close-btn" data-dismiss="modal">Run on background</button>
                </div>
            </div>
        </div>
    </div>
    <!-- / Install/Update -->
</body>

</html>